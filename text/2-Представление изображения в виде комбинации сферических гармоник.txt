Ниже описывается способ представления освещения при помощи сферических гармоник. В данной работе рассматривается диффузная модель освещения при которой яркость точки поверхности можно представить в виде:

<B(p) = ... форм. диффуз осв. > 2.1

где B(p) - отраженный свет, n - нормаль к поверхности в точке p, L(\omega) - oсв.

В [рамамурти_сф_гарм]  описывается подход к анализу изображений трёхмерных объектов, основанный на разложении B(p) на сферические гармоники. Сферические гармоники представляют собой набор функций, формирующих отртонормированный базис для функций заданных на единичной сфере (к каким можно отнести и функцию (2.1)). 

Сферические гармоники Y\sup(lm) задаются в виде:

<формула сф. гармоник> (2.2)

Первые 3 порядка выглядят следующим образом:

<9 формул> (2.3-2.11)

Для анализа освещённости формулы 2.3 - 2.11 можно записать как функции проекций орта нормали:

<9 формул> (2.12-2.20)

В [джанг сф. гарм.] показано, что для разложения освещённости объектов достаточно вышепреведённых первых девяти функций. Таким образом, изображение можно представить в виде: 
<formula I=B'*alpha+E> 2.21
где I - вектор-столбец пикселей изображения размерности d, B - матрица размерности 9*d, где каждая строка соответствует сферической гармонике, \alpha - вектор-столбец коэффициентов разложения размерности 9, E - вектор-столбец размерности d, содержащий невязку между реальным изображением и линейной комбинацией \B'*alpha. При этом вся информация об условиях освещения содержится в векторе \alpha, а матрица B содержит информацию о форме поверхности, которая, очевидно, не зависит от условий освещения и может быть использована в качестве информативных признаков, инвариантных к освещению.

На рис 2.1 показан пример разложения изображения на сферические гармоники.

<рис 2.1>

Далее в части 3 приведён алгоритм восстановления коеффициентов разложения на сферические гармоники для изображения с произвольным освещением, а в части 4 описан способ восстановления базисных изображений. 

